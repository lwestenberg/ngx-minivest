<div class="grid grid-cols-1 lg:grid-cols-2 gap-8 items-start">
  <!-- Form Column -->
  <div class="bg-white shadow-xl rounded-lg p-8">
    <h2 class="text-2xl font-bold text-blue-600 mb-6">Nested Form Example</h2>
    <p class="text-gray-600 mb-6">
      This form demonstrates how to handle nested form fields (ngModelGroup) with template-driven forms and
      Vest.js validation.
    </p>

    <!-- Form Column -->
    <form (submit)="onSubmit($event)" class="space-y-6">
      <!-- Personal Information Section -->
      <fieldset class="space-y-4">
        <legend class="text-lg font-semibold text-gray-800 border-b pb-2 mb-4">
          Personal Information
        </legend>

        <div class="grid grid-cols-2 gap-4">
          <div class="space-y-2">
            <label class="block text-sm font-medium text-gray-700" for="firstName">
              First Name:
            </label>
            <input
              type="text"
              id="firstName"
              name="firstName"
              (input)="setValue('personalInfo.firstName', $event.target.value)"
              (blur)="setTouched('personalInfo.firstName')"
              [value]="formValue().personalInfo?.firstName"
              placeholder="Enter first name"
              class="w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
              [class.border-red-500]="minivest().showErrors['personalInfo.firstName']"
              [class.border-gray-300]="!minivest().showErrors['personalInfo.firstName']"
            />

            @if (minivest().showErrors['personalInfo.firstName']) {
              <div class="text-sm text-red-600">
                {{ minivest().getErrors('personalInfo.firstName')[0] }}
              </div>
            }
          </div>

          <div class="space-y-2">
            <label class="block text-sm font-medium text-gray-700" for="lastName">
              Last Name:
            </label>
            <input
              type="text"
              id="lastName"
              name="lastName"
              [value]="formValue().personalInfo?.lastName"
              (blur)="setTouched('personalInfo.lastName')"
              (input)="setValue('personalInfo.lastName', $event.target.value)"
              placeholder="Enter last name"
              class="w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
              [class.border-red-500]="minivest().showErrors['personalInfo.lastName']"
              [class.border-gray-300]="!minivest().showErrors['personalInfo.lastName']"
            />

            @if (minivest().showErrors['personalInfo.lastName']) {
              <div class="text-sm text-red-600">
                {{ minivest().getErrors('personalInfo.lastName')[0] }}
              </div>
            }
          </div>
        </div>

        <div class="space-y-2">
          <label class="block text-sm font-medium text-gray-700" for="email">
            Email Address:
          </label>
          <input
            type="email"
            id="email"
            name="email"
            [value]="formValue().personalInfo?.email"
            (input)="setValue('personalInfo.email', $event.target.value)"
            (blur)="setTouched('personalInfo.email')"
            placeholder="Enter email address"
            class="w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
            [class.border-red-500]="minivest().showErrors['personalInfo.email']"
            [class.border-gray-300]="!minivest().showErrors['personalInfo.email']"
          />

          @if (minivest().showErrors['personalInfo.email']) {
            <div class="text-sm text-red-600">
              {{ minivest().getErrors('personalInfo.email')[0] }}
            </div>
          }
        </div>
      </fieldset>

      <!-- Address Information Section -->
      <fieldset ngModelGroup="addressInfo" #addressInfoGroup="ngModelGroup" class="space-y-4">
        <legend class="text-lg font-semibold text-gray-800 border-b pb-2 mb-4">
          Address Information
        </legend>

        <div class="space-y-2">
          <label class="block text-sm font-medium text-gray-700" for="street">
            Street Address:
          </label>
          <input
            type="text"
            id="street"
            name="street"
            [value]="formValue().addressInfo?.street"
            (input)="setValue('addressInfo.street', $event.target.value)"
            (blur)="setTouched('addressInfo.street')"
            placeholder="Enter street address"
            class="w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
            [class.border-red-500]="minivest().showErrors['addressInfo.street']"
            [class.border-gray-300]="!minivest().showErrors['addressInfo.street']"
          />

          @if (minivest().showErrors['addressInfo.street']) {
            <div class="text-sm text-red-600">
              {{ minivest().getErrors('addressInfo.street')[0] }}
            </div>
          }
        </div>

        <div class="grid grid-cols-2 gap-4">
          <div class="space-y-2">
            <label class="block text-sm font-medium text-gray-700" for="city"> City: </label>
            <input
              type="text"
              id="city"
              name="city"
              [value]="formValue().addressInfo?.city"
              (input)="setValue('addressInfo.city', $event.target.value)"
              (blur)="setTouched('addressInfo.city')"
              placeholder="Enter city"
              class="w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
              [class.border-red-500]="minivest().showErrors['addressInfo.city']"
              [class.border-gray-300]="!minivest().showErrors['addressInfo.city']"
            />

            @if (minivest().showErrors['addressInfo.city']) {
              <div class="text-sm text-red-600">
                {{ minivest().getErrors('addressInfo.city')[0] }}
              </div>
            }
          </div>

          <div class="space-y-2">
            <label class="block text-sm font-medium text-gray-700" for="zipCode">
              ZIP Code:
            </label>
            <input
              type="text"
              id="zipCode"
              name="zipCode"
              [value]="formValue().addressInfo?.zipCode"
              (input)="setValue('addressInfo.zipCode', $event.target.value)"
              (blur)="setTouched('addressInfo.zipCode')"
              placeholder="12345 or 12345-6789"
              class="w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
              [class.border-red-500]="minivest().showErrors['addressInfo.zipCode']"
              [class.border-gray-300]="!minivest().showErrors['addressInfo.zipCode']"
            />

            @if (minivest().showErrors['addressInfo.zipCode']) {
              <div class="text-sm text-red-600">
                {{ minivest().getErrors('addressInfo.zipCode')[0] }}
              </div>
            }
          </div>
        </div>

        <div class="space-y-2">
          <label class="block text-sm font-medium text-gray-700" for="country"> Country: </label>
          <select
            id="country"
            name="country"
            [value]="formValue().addressInfo?.country"
            (blur)="setTouched('addressInfo.country')"
            class="w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
            [class.border-red-500]="minivest().showErrors['addressInfo.country']"
            [class.border-gray-300]="!minivest().showErrors['addressInfo.country']"
          >
            <option value="">Select a country</option>
            <option value="US">United States</option>
            <option value="CA">Canada</option>
            <option value="UK">United Kingdom</option>
            <option value="DE">Germany</option>
            <option value="FR">France</option>
            <option value="NL">Netherlands</option>
            <option value="OTHER">Other</option>
          </select>

          @if (minivest().showErrors['addressInfo.country']) {
            <div class="text-sm text-red-600">
              {{ minivest().getErrors('addressInfo.country')[0] }}
            </div>
          }
        </div>
      </fieldset>

      <!-- Preferences Section -->
      <fieldset ngModelGroup="preferences" #preferencesGroup="ngModelGroup" class="space-y-4">
        <legend class="text-lg font-semibold text-gray-800 border-b pb-2 mb-4">
          Preferences
        </legend>

        <div class="space-y-3">
          <div class="flex items-center space-x-2">
            <input 
              type="checkbox" 
              id="newsletter"
              name="newsletter"
              (input)="setValue('preferences.newsletter', $event.target.checked)"
              (blur)="setTouched('preferences.newsletter')"
              class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"
            />
            <label class="text-sm font-medium text-gray-700" for="newsletter">
              Subscribe to newsletter
            </label>
          </div>

          <div class="flex items-center space-x-2">
            <input 
              type="checkbox" 
              id="notifications"
              name="notifications"
              [ngModel]="formValue().preferences?.notifications"
              (ngModelChange)="setValue('preferences.notifications', $event)"
              class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"
              />
            <label class="text-sm font-medium text-gray-700" for="notifications">
              Enable email notifications
            </label>
          </div>
        </div>
      </fieldset>

      <button
        type="submit"
        class="w-full bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white font-medium py-2 px-4 rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"
      >
        Submit
      </button>
    </form>
  </div>

    <!-- Debugger Column -->
    <app-debugger [formValue]="formValue()" [minivest]="minivest()">
    </app-debugger>
</div>
